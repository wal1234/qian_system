<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qian.system.mapper.UserMapper">
    
    <resultMap type="com.qian.system.domain.User" id="UserResult">
        <id     property="id"           column="id"            />
        <result property="username"     column="username"      />
        <result property="password"     column="password"      />
        <result property="nickname"     column="nickname"      />
        <result property="email"        column="email"         />
        <result property="avatar"       column="avatar"        />
        <result property="phone"        column="phone"         />
        <result property="role"         column="role"          />
        <result property="status"       column="status"        />
        <result property="loginIp"      column="login_ip"      />
        <result property="loginDate"    column="login_date"    />
        <result property="createBy"     column="create_by"     />
        <result property="createTime"   column="create_time"   />
        <result property="updateBy"     column="update_by"     />
        <result property="updateTime"   column="update_time"   />
        <result property="remark"       column="remark"        />
        <result property="deleted"      column="deleted"       />
    </resultMap>
    
    <select id="selectUserByUserName" parameterType="String" resultMap="UserResult">
        SELECT * FROM sys_user WHERE user_name = #{userName} LIMIT 1
    </select>

    <select id="selectUserByPhoneNumber" parameterType="String" resultMap="UserResult">
        SELECT * FROM sys_user WHERE phone_number = #{phoneNumber} LIMIT 1
    </select>

    <select id="selectUserByEmailAddress" parameterType="String" resultMap="UserResult">
        SELECT * FROM sys_user WHERE email_address = #{emailAddress} LIMIT 1
    </select>

    <select id="countAdminUserByIds" parameterType="array" resultType="int">
        SELECT COUNT(*) FROM sys_user WHERE id IN
        <foreach collection="array" item="userId" open="(" separator="," close=")">
            #{userId}
        </foreach>
        AND user_name = 'admin'
    </select>
</mapper> 